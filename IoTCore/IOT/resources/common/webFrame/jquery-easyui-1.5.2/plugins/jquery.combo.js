/**
 * jQuery EasyUI 1.5.2
 * 
 * Copyright (c) 2009-2017 www.jeasyui.com. All rights reserved.
 *
 * Licensed under the freeware license: http://www.jeasyui.com/license_freeware.php
 * To use it on other terms please contact us: info@jeasyui.com
 *
 */
(function(b){function t(a){var c=b.data(a,"combo"),d=c.options;c.panel||(c.panel=b('\x3cdiv class\x3d"combo-panel"\x3e\x3c/div\x3e').appendTo("body"),c.panel.panel({minWidth:d.panelMinWidth,maxWidth:d.panelMaxWidth,minHeight:d.panelMinHeight,maxHeight:d.panelMaxHeight,doSize:!1,closed:!0,cls:"combo-p",style:{position:"absolute",zIndex:10},onOpen:function(){var a=b(this).panel("options").comboTarget,c=b.data(a,"combo");c&&c.options.onShowPanel.call(a)},onBeforeClose:function(){q(b(this).parent())},onClose:function(){var a=b(this).panel("options").comboTarget,c=b(a).data("combo");c&&c.options.onHidePanel.call(a)}}));var g=b.extend(!0,[],d.icons);d.hasDownArrow&&g.push({iconCls:"combo-arrow",handler:function(a){r(a.data.target)}});b(a).addClass("combo-f").textbox(b.extend({},d,{icons:g,onChange:function(){}}));b(a).attr("comboName",b(a).attr("textboxName"));c.combo=b(a).next();c.combo.addClass("combo")}function r(a){var c=b.data(a,"combo").panel;if(c.is(":visible"))c=c.combo("combo"),k(c),c!=a&&b(a).combo("showPanel");else{var d=b(a).closest("div.combo-p").children(".combo-panel");b("div.combo-panel:visible").not(c).not(d).panel("close");b(a).combo("showPanel")}b(a).combo("textbox").focus()}function q(a){b(a).find(".combo-f").each(function(){var a=b(this).combo("panel");a.is(":visible")&&a.panel("close")})}function m(a){var c=a.data.target,d=b(c),g=d.data("combo"),e=d.combo("options");g.panel.panel("options").comboTarget=c;switch(a.keyCode){case 38:e.keyHandler.up.call(c,a);break;case 40:e.keyHandler.down.call(c,a);break;case 37:e.keyHandler.left.call(c,a);break;case 39:e.keyHandler.right.call(c,a);break;case 13:return a.preventDefault(),e.keyHandler.enter.call(c,a),!1;case 9:case 27:k(c);break;default:e.editable&&(g.timer&&clearTimeout(g.timer),g.timer=setTimeout(function(){var b=d.combo("getText");g.previousText!=b&&(g.previousText=b,d.combo("showPanel"),e.keyHandler.query.call(c,b,a),d.combo("validate"))},e.delay))}}function u(a){function c(){var a=e.offset().left;"right"==h.panelAlign&&(a+=e._outerWidth()-f._outerWidth());a+f._outerWidth()>b(window)._outerWidth()+b(document).scrollLeft()&&(a=b(window)._outerWidth()+b(document).scrollLeft()-f._outerWidth());0>a&&(a=0);return a}function d(){var a=e.offset().top+e._outerHeight();a+f._outerHeight()>b(window)._outerHeight()+b(document).scrollTop()&&(a=e.offset().top-f._outerHeight());a<b(document).scrollTop()&&(a=e.offset().top+e._outerHeight());return a}var g=b.data(a,"combo"),e=g.combo,f=g.panel,h=b(a).combo("options"),n=f.panel("options");n.comboTarget=a;n.closed&&(f.panel("panel").show().css({zIndex:b.fn.menu?b.fn.menu.defaults.zIndex++:b.fn.window?b.fn.window.defaults.zIndex++:99,left:-999999}),f.panel("resize",{width:h.panelWidth?h.panelWidth:e._outerWidth(),height:h.panelHeight}),f.panel("panel").hide(),f.panel("open"));(function(){n.comboTarget==a&&f.is(":visible")&&(f.panel("move",{left:c(),top:d()}),setTimeout(arguments.callee,200))})()}function k(a){b.data(a,"combo").panel.panel("close")}function p(a){var c=b.data(a,"combo").options,d=[];b(a).next().find(".textbox-value").each(function(){d.push(b(this).val())});return c.multivalue?d:d.length?d[0].split(c.separator):d}function l(a,c){function d(c){var d=b(a).attr("textboxName")||"",f=b('\x3cinput type\x3d"hidden" class\x3d"textbox-value"\x3e').appendTo(g);f.attr("name",d);e.disabled&&f.attr("disabled","disabled");f.val(c)}var g=b.data(a,"combo").combo,e=b(a).combo("options");b.isArray(c)||(c=c.split(e.separator));var f=p(a);g.find(".textbox-value").remove();if(c.length)if(e.multivalue)for(var h=0;h<c.length;h++)d(c[h]);else d(c.join(e.separator));(function(){if(f.length!=c.length)return!0;for(var a=0;a<c.length;a++)if(c[a]!=f[a])return!0;return!1})()&&(b(a).val(c.join(e.separator)),e.multiple?e.onChange.call(a,c,f):e.onChange.call(a,c[0],f[0]),b(a).closest("form").trigger("_change",[a]))}function v(a){var c=b.data(a,"combo").options,d=c.onChange;c.onChange=function(){};c.multiple?l(a,c.value?c.value:[]):l(a,[c.value]);c.onChange=d}b(function(){b(document).unbind(".combo").bind("mousedown.combo mousewheel.combo",function(a){a=b(a.target).closest("span.combo,div.combo-p,div.menu");a.length?q(a):b("body\x3ediv.combo-p\x3ediv.combo-panel:visible").panel("close")})});b.fn.combo=function(a,c){if("string"==typeof a){var d=b.fn.combo.methods[a];return d?d(this,c):this.textbox(a,c)}a=a||{};return this.each(function(){var c=b.data(this,"combo");c?(b.extend(c.options,a),void 0!=a.value&&(c.options.originalValue=a.value)):(c=b.data(this,"combo",{options:b.extend({},b.fn.combo.defaults,b.fn.combo.parseOptions(this),a),previousText:""}),c.options.originalValue=c.options.value);t(this);v(this)})};b.fn.combo.methods={options:function(a){var c=a.textbox("options");return b.extend(b.data(a[0],"combo").options,{width:c.width,height:c.height,disabled:c.disabled,readonly:c.readonly})},cloneFrom:function(a,c){return a.each(function(){b(this).textbox("cloneFrom",c);b.data(this,"combo",{options:b.extend(!0,{cloned:!0},b(c).combo("options")),combo:b(this).next(),panel:b(c).combo("panel")});b(this).addClass("combo-f").attr("comboName",b(this).attr("textboxName"))})},combo:function(a){return a.closest(".combo-panel").panel("options").comboTarget},panel:function(a){return b.data(a[0],"combo").panel},destroy:function(a){return a.each(function(){var a=b.data(this,"combo"),d=a.options,a=a.panel;a.is(":visible")&&a.panel("close");d.cloned||a.panel("destroy");b(this).textbox("destroy")})},showPanel:function(a){return a.each(function(){u(this)})},hidePanel:function(a){return a.each(function(){k(this)})},clear:function(a){return a.each(function(){b(this).textbox("setText","");b.data(this,"combo").options.multiple?b(this).combo("setValues",[]):b(this).combo("setValue","")})},reset:function(a){return a.each(function(){var a=b.data(this,"combo").options;a.multiple?b(this).combo("setValues",a.originalValue):b(this).combo("setValue",a.originalValue)})},setText:function(a,c){return a.each(function(){var a=b.data(this,"combo");b(this).textbox("getText")!=c&&b(this).textbox("setText",c);a.previousText=c})},getValues:function(a){return p(a[0])},setValues:function(a,b){return a.each(function(){l(this,b)})},getValue:function(a){return p(a[0])[0]},setValue:function(a,b){return a.each(function(){l(this,[b])})}};b.fn.combo.parseOptions=function(a){var c=b(a);return b.extend({},b.fn.textbox.parseOptions(a),b.parser.parseOptions(a,["separator","panelAlign",{panelWidth:"number",hasDownArrow:"boolean",delay:"number",reversed:"boolean",multivalue:"boolean",selectOnNavigation:"boolean"},{panelMinWidth:"number",panelMaxWidth:"number",panelMinHeight:"number",panelMaxHeight:"number"}]),{panelHeight:"auto"==c.attr("panelHeight")?"auto":parseInt(c.attr("panelHeight"))||void 0,multiple:c.attr("multiple")?!0:void 0})};b.fn.combo.defaults=b.extend({},b.fn.textbox.defaults,{inputEvents:{click:function(a){var c=a.data.target;b.data(c,"combo").options.editable?(a=b(c).closest("div.combo-p").children(".combo-panel"),b("div.combo-panel:visible").not(a).each(function(){var a=b(this).combo("combo");a!=c&&k(a)})):r(c)},keydown:m,paste:m,drop:m},panelWidth:null,panelHeight:200,panelMinWidth:null,panelMaxWidth:null,panelMinHeight:null,panelMaxHeight:null,panelAlign:"left",reversed:!1,multiple:!1,multivalue:!0,selectOnNavigation:!0,separator:",",hasDownArrow:!0,delay:200,keyHandler:{up:function(a){},down:function(a){},left:function(a){},right:function(a){},enter:function(a){},query:function(a,b){}},onShowPanel:function(){},onHidePanel:function(){},onChange:function(a,b){}})})(jQuery);