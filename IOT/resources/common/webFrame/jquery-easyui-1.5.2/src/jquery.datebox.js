/**
 * jQuery EasyUI 1.5.2
 * 
 * Copyright (c) 2009-2017 www.jeasyui.com. All rights reserved.
 *
 * Licensed under the freeware license: http://www.jeasyui.com/license_freeware.php
 * To use it on other terms please contact us: info@jeasyui.com
 *
 */
/**
 * datebox - jQuery EasyUI
 * 
 * Dependencies:
 * 	 calendar
 *   combo
 * 
 */
(function(b){function n(a){function c(a){var c=b(a).datebox("options");b(a).combo("panel").unbind(".datebox").bind("click.datebox",function(d){if(b(d.target).hasClass("datebox-button-a")){var e=parseInt(b(d.target).attr("datebox-button-index"));c.buttons[e].handler.call(d.target,a)}})}function e(a){var c=b(a).combo("panel"),e=c.children("div.datebox-calendar-inner");c.children()._outerWidth(c.width());d.calendar.appendTo(e);d.calendar[0].target=a;if("auto"!=f.panelHeight){var l=c.height();c.children().not(e).each(function(){l-=b(this).outerHeight()});e._outerHeight(l)}d.calendar.calendar("resize")}var d=b.data(a,"datebox"),f=d.options;b(a).addClass("datebox-f").combo(b.extend({},f,{onShowPanel:function(){c(this);var a=b(this).combo("panel");if(!a.children("div.datebox-button").length){for(var a=b('\x3cdiv class\x3d"datebox-button"\x3e\x3ctable cellspacing\x3d"0" cellpadding\x3d"0" style\x3d"width:100%"\x3e\x3ctr\x3e\x3c/tr\x3e\x3c/table\x3e\x3c/div\x3e').appendTo(a).find("tr"),d=0;d<f.buttons.length;d++){var h=b("\x3ctd\x3e\x3c/td\x3e").appendTo(a),g=f.buttons[d];b('\x3ca class\x3d"datebox-button-a" href\x3d"javascript:;"\x3e\x3c/a\x3e').html(b.isFunction(g.text)?g.text(this):g.text).appendTo(h).attr("datebox-button-index",d)}a.find("td").css("width",100/f.buttons.length+"%")}e(this);k(this,b(this).datebox("getText"),!0);f.onShowPanel.call(this)}}));if(!d.calendar){var g=b(a).combo("panel").css("overflow","hidden");g.panel("options").onBeforeDestroy=function(){var a=b(this).find(".calendar-shared");a.length&&a.insertBefore(a[0].pholder)};g=b('\x3cdiv class\x3d"datebox-calendar-inner"\x3e\x3c/div\x3e').prependTo(g);if(f.sharedCalendar){var h=b(f.sharedCalendar);h[0].pholder||(h[0].pholder=b('\x3cdiv class\x3d"calendar-pholder" style\x3d"display:none"\x3e\x3c/div\x3e').insertAfter(h));h.addClass("calendar-shared").appendTo(g);h.hasClass("calendar")||h.calendar();d.calendar=h}else d.calendar=b("\x3cdiv\x3e\x3c/div\x3e").appendTo(g).calendar();b.extend(d.calendar.calendar("options"),{fit:!0,border:!1,onSelect:function(a){var c=this.target,d=b(c).datebox("options");k(c,d.formatter.call(c,a));b(c).combo("hidePanel");d.onSelect.call(c,a)}})}b(a).combo("textbox").parent().addClass("datebox");b(a).datebox("initValue",f.value)}function m(a){var c=b.data(a,"datebox"),e=c.options;if(c=c.calendar.calendar("options").current)k(a,e.formatter.call(a,c)),b(a).combo("hidePanel")}function k(a,c,e){var d=b.data(a,"datebox"),f=d.options,d=d.calendar;d.calendar("moveTo",f.parser.call(a,c));e?b(a).combo("setValue",c):(c&&(c=f.formatter.call(a,d.calendar("options").current)),b(a).combo("setText",c).combo("setValue",c))}b.fn.datebox=function(a,c){if("string"==typeof a){var e=b.fn.datebox.methods[a];return e?e(this,c):this.combo(a,c)}a=a||{};return this.each(function(){var c=b.data(this,"datebox");c?b.extend(c.options,a):b.data(this,"datebox",{options:b.extend({},b.fn.datebox.defaults,b.fn.datebox.parseOptions(this),a)});n(this)})};b.fn.datebox.methods={options:function(a){var c=a.combo("options");return b.extend(b.data(a[0],"datebox").options,{width:c.width,height:c.height,originalValue:c.originalValue,disabled:c.disabled,readonly:c.readonly})},cloneFrom:function(a,c){return a.each(function(){b(this).combo("cloneFrom",c);b.data(this,"datebox",{options:b.extend(!0,{},b(c).datebox("options")),calendar:b(c).datebox("calendar")});b(this).addClass("datebox-f")})},calendar:function(a){return b.data(a[0],"datebox").calendar},initValue:function(a,c){return a.each(function(){var a=b(this).datebox("options"),c=a.value;c&&(c=a.formatter.call(this,a.parser.call(this,c)));b(this).combo("initValue",c).combo("setText",c)})},setValue:function(a,c){return a.each(function(){k(this,c)})},reset:function(a){return a.each(function(){var a=b(this).datebox("options");b(this).datebox("setValue",a.originalValue)})}};b.fn.datebox.parseOptions=function(a){return b.extend({},b.fn.combo.parseOptions(a),b.parser.parseOptions(a,["sharedCalendar"]))};b.fn.datebox.defaults=b.extend({},b.fn.combo.defaults,{panelWidth:180,panelHeight:"auto",sharedCalendar:null,keyHandler:{up:function(a){},down:function(a){},left:function(a){},right:function(a){},enter:function(a){m(this)},query:function(a,c){k(this,a,!0)}},currentText:"Today",closeText:"Close",okText:"Ok",buttons:[{text:function(a){return b(a).datebox("options").currentText},handler:function(a){var c=new Date;b(a).datebox("calendar").calendar({year:c.getFullYear(),month:c.getMonth()+1,current:new Date(c.getFullYear(),c.getMonth(),c.getDate())});m(a)}},{text:function(a){return b(a).datebox("options").closeText},handler:function(a){b(this).closest("div.combo-panel").panel("close")}}],formatter:function(a){var c=a.getFullYear(),b=a.getMonth()+1;a=a.getDate();return(10>b?"0"+b:b)+"/"+(10>a?"0"+a:a)+"/"+c},parser:function(a){if(!a)return new Date;var b=a.split("/");a=parseInt(b[0],10);var e=parseInt(b[1],10),b=parseInt(b[2],10);return isNaN(b)||isNaN(a)||isNaN(e)?new Date:new Date(b,a-1,e)},onSelect:function(a){}})})(jQuery);