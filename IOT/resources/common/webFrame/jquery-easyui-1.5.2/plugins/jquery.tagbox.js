/**
 * jQuery EasyUI 1.5.2
 * 
 * Copyright (c) 2009-2017 www.jeasyui.com. All rights reserved.
 *
 * Licensed under the freeware license: http://www.jeasyui.com/license_freeware.php
 * To use it on other terms please contact us: info@jeasyui.com
 *
 */
(function(a){function q(b){function c(){a(b).next().find(".tagbox-label").remove();var c=a(b).tagbox("textbox");a.map(a(b).tagbox("getValues"),function(e,g){var f,h;h=d.finder.getRow(b,e);var k=d.tagFormatter.call(b,e,h);f=d.tagStyler.call(b,e,h)||"";"string"==typeof f?h=void 0:(h=f["class"]||"",f=f.style||"");k=a('\x3cspan class\x3d"tagbox-label"\x3e\x3c/span\x3e').insertBefore(c).html(k);k.attr("tagbox-index",g);k.attr("style",f).addClass(h);a('\x3ca href\x3d"javascript:;" class\x3d"tagbox-remove"\x3e\x3c/a\x3e').appendTo(k)});n(b);a(b).combobox("setText","")}var d=a.data(b,"tagbox").options;a(b).addClass("tagbox-f").combobox(a.extend({},d,{cls:"tagbox",reversed:!0,onChange:function(e,f){c();a(this).combobox("hidePanel");d.onChange.call(b,e,f)},onResizing:function(c,f){var e=a(this).combobox("textbox"),m=a(this).data("textbox").textbox;m.css({height:"",paddingLeft:e.css("marginLeft"),paddingRight:e.css("marginRight")});e.css("margin",0);m._size({width:d.width},a(this).parent());l(b);n(this);d.onResizing.call(b,c,f)},onLoadSuccess:function(a){c();d.onLoadSuccess.call(b,a)}}));c();l(b)}function n(b,c){var d=a(b).next(),e=c?a(c):d.find(".tagbox-label");if(e.length){var f=a(b).tagbox("textbox"),g=a(e[0]),g=g.outerHeight(!0)-g.outerHeight(),f=f.outerHeight()-2*g;e.css({height:f+"px",lineHeight:f+"px"});d.find(".textbox-addon").css("height","100%").find(".textbox-icon").css("height","100%");d.find(".textbox-button").linkbutton("resize",{height:"100%"})}}function r(b){a(b).next().unbind(".tagbox").bind("click.tagbox",function(c){var d=a(b).tagbox("options");if(!d.disabled&&!d.readonly){if(a(c.target).hasClass("tagbox-remove")){c=parseInt(a(c.target).parent().attr("tagbox-index"));var e=a(b).tagbox("getValues");if(0==d.onBeforeRemoveTag.call(b,e[c]))return;d.onRemoveTag.call(b,e[c]);e.splice(c,1);a(b).tagbox("setValues",e)}else c=a(c.target).closest(".tagbox-label"),c.length&&(c=parseInt(c.attr("tagbox-index")),e=a(b).tagbox("getValues"),d.onClickTag.call(b,e[c]));a(this).find(".textbox-text").focus()}}).bind("keyup.tagbox",function(a){l(b)}).bind("mouseover.tagbox",function(b){a(b.target).closest(".textbox-button,.textbox-addon,.tagbox-label").length?a(this).triggerHandler("mouseleave"):a(this).find(".textbox-text").triggerHandler("mouseenter")}).bind("mouseleave.tagbox",function(b){a(this).find(".textbox-text").triggerHandler("mouseleave")})}function l(b){function c(a){a=a.replace(/&/g,"\x26amp;").replace(/\s/g," ").replace(/</g,"\x26lt;").replace(/>/g,"\x26gt;");f.html(a);return f.outerWidth()}var d=a(b).tagbox("options"),e=a(b).tagbox("textbox");b=a(b).next();var f=a("\x3cspan\x3e\x3c/span\x3e").appendTo("body");f.attr("style",e.attr("style"));f.css({position:"absolute",top:-9999,left:-9999,width:"auto",fontFamily:e.css("fontFamily"),fontSize:e.css("fontSize"),fontWeight:e.css("fontWeight"),whiteSpace:"nowrap"});var g=c(e.val()),d=c(d.prompt||"");f.remove();d=Math.min(Math.max(g,d)+20,b.width());e._outerWidth(d);b.find(".textbox-button").linkbutton("resize",{height:"100%"})}function p(b){var c=a(b),d=c.tagbox("options");d.limitToList?(c=c.tagbox("panel").children("div.combobox-item-hover"),c.length&&(c.removeClass("combobox-item-hover"),d=d.finder.getRow(b,c)[d.valueField],a(b).tagbox(c.hasClass("combobox-item-selected")?"unselect":"select",d)),a(b).tagbox("hidePanel")):(d=a.trim(a(b).tagbox("getText")),""!==d&&(c=a(b).tagbox("getValues"),c.push(d),a(b).tagbox("setValues",c)))}a.fn.tagbox=function(b,c){if("string"==typeof b){var d=a.fn.tagbox.methods[b];return d?d(this,c):this.combobox(b,c)}b=b||{};return this.each(function(){var c=a.data(this,"tagbox");c?a.extend(c.options,b):a.data(this,"tagbox",{options:a.extend({},a.fn.tagbox.defaults,a.fn.tagbox.parseOptions(this),b)});q(this);r(this)})};a.fn.tagbox.methods={options:function(b){var c=b.combobox("options");return a.extend(a.data(b[0],"tagbox").options,{width:c.width,height:c.height,originalValue:c.originalValue,disabled:c.disabled,readonly:c.readonly})},setValues:function(b,c){return b.each(function(){a(this).combobox("setText","");l(this);a(this).combobox("setValues",c);a(this).combobox("setText","");a(this).tagbox("validate")})}};a.fn.tagbox.parseOptions=function(b){return a.extend({},a.fn.combobox.parseOptions(b),a.parser.parseOptions(b,[]))};a.fn.tagbox.defaults=a.extend({},a.fn.combobox.defaults,{hasDownArrow:!1,multiple:!0,reversed:!0,selectOnNavigation:!1,tipOptions:a.extend({},a.fn.textbox.defaults.tipOptions,{showDelay:200}),val:function(b){var c=a(b).parent().prev().tagbox("getValues");a(b).is(":focus")&&c.push(a(b).val());return c.join(",")},inputEvents:a.extend({},a.fn.combo.defaults.inputEvents,{blur:function(b){b=b.data.target;a(b).tagbox("options").limitToList&&p(b)}}),keyHandler:a.extend({},a.fn.combobox.defaults.keyHandler,{enter:function(a){p(this)},query:function(b,c){a(this).tagbox("options").limitToList?a.fn.combobox.defaults.keyHandler.query.call(this,b,c):a(this).combobox("hidePanel")}}),tagFormatter:function(b,c){var d=a(this).tagbox("options");return c?c[d.textField]:b},tagStyler:function(a,c){return""},onClickTag:function(a){},onBeforeRemoveTag:function(a){},onRemoveTag:function(a){}})})(jQuery);